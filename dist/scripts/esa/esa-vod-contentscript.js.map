{"version":3,"sources":["scripts/esa/esa-vod-contentscript.js"],"names":["retrieveGameTitleList","$","each","gameArray","push","this","text","loadHighlightStorage","localStorage","getItem","setItem","JSON","stringify","storageObj","parse","chrome","storage","sync","set","esa16scheduleHighlights","console","log","addHighlights","after","index","html","that","change","is","parent","css","gameTitle","getGameTitleString","next","data","prop","addSpeedrunLinks","getJSON","done","resp","scheduleJSON","clonedElement","clone","find","remove","clonedXS","append","title","includes","gameTitleString","split","addVodLinks","titles","_","keys","templateString","generateVodString","filter","twitchString","youtubeString","document","ready"],"mappings":"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","file":"scripts/esa/esa-vod-contentscript.js","sourcesContent":["'use strict';\n\nvar gameArray = [];\nvar storageObj = null;\n$(document).ready(function () {\n  retrieveGameTitleList();\n  loadHighlightStorage();\n  addHighlights();\n  addSpeedrunLinks();\n  addVodLinks();\n});\n\nfunction retrieveGameTitleList() {\n  $('tr.border-top:not(.row2) td.center-sm').each(function () {\n    gameArray.push($(this).text());\n  });\n}\n\nfunction loadHighlightStorage() {\n  if (localStorage.getItem('esa16scheduleHighlights') == null) {\n    localStorage.setItem('esa16scheduleHighlights', JSON.stringify({}));\n    storageObj = JSON.parse(localStorage.getItem('esa16scheduleHighlights'));\n  } else {\n    storageObj = JSON.parse(localStorage.getItem('esa16scheduleHighlights'));\n    chrome.storage.sync.set({ 'esa16scheduleHighlights': storageObj }, function () {\n      console.log('Schedule highlights saved to sync storage');\n    });\n  }\n}\n\nfunction addHighlights() {\n  $('.schedulenote').after('<div class=\"panel panel-body center\" id=\"star-highlight-notice\" style=\"font-size: 16px;\">Clicking the <i class=\"fa fa-star-o\"></i> beside the run will highlight it!<br >Use this to keep track of runs you want to watch.</h4>');\n\n  $('tr.border-top:not(.row2) td:nth-child(1)').each(function (index) {\n    $(this).html('<input type=\"checkbox\" class=\"highlight-run\" name=\"checkbox\" id=\"theater-mode' + index + '\"> <label for=\"theater-mode' + index + '\">' + $(this).text() + '</label>');\n    var that = $(this);\n    $('#theater-mode' + index).change(function () {\n      if ($(this).is(\":checked\")) {\n        that.parent().css('background-color', '#444');\n\n        var gameTitle = getGameTitleString(that.next('td').text());\n\n        storageObj[gameTitle] = true;\n\n        chrome.storage.sync.set({ 'esa16scheduleHighlights': storageObj }, function (data) {\n          console.log(\"Schedule highlights updated and saved to sync storage\");\n        });\n        localStorage.setItem('esa16scheduleHighlights', JSON.stringify(storageObj));\n        console.log('Starred and highlighted ' + gameTitle + ' on the schedule');\n      } else {\n        that.parent().css('background-color', 'transparent');\n\n        var gameTitle = getGameTitleString(that.next('td').text());\n\n        storageObj[gameTitle] = false;\n\n        localStorage.setItem('esa16scheduleHighlights', JSON.stringify(storageObj));\n        chrome.storage.sync.set({ 'esa16scheduleHighlights': storageObj }, function () {\n          console.log(\"Schedule highlights updated\");\n        });\n        console.log('Removed the star and highlight for ' + gameTitle + ' on the schedule');\n      }\n    });\n\n    if (storageObj[that.next('td').text()] == true) {\n      $('#theater-mode' + index).prop(\"checked\", true).change();\n    }\n  });\n}\n\nfunction addSpeedrunLinks() {\n  $.getJSON('https://gist.githubusercontent.com/theoriginalcamper/cde736fb9e43b34cf8f49c0c82d7c564/raw/esa_schedule2016.json').done(function (resp) {\n    var scheduleJSON = resp;\n    $('tr.border-top:not(.row2) td.center-sm:not(:has(> a))').each(function () {\n      var clonedElement = $(this).clone();\n      clonedElement.find('.visible-xs').remove();\n      var clonedXS = $('.visible-xs', this);\n\n      var gameTitle = clonedElement.text();\n      console.log(gameTitle);\n      if (scheduleJSON[gameTitle]['link'] != null) {\n        console.log(gameTitle);\n        $(this).html('<a href=\"' + scheduleJSON[gameTitle]['link'] + '\">' + gameTitle + '</a>');\n        $(this).append(clonedXS);\n      }\n    });\n\n    $('tr.border-top:not(.row2) td.center-sm:contains(Mega Man)').each(function () {\n      var gameTitle = $(this).text();\n      if (scheduleJSON[gameTitle]['link'] != null) {\n        console.log(gameTitle);\n        $(this).html('<a href=\"' + scheduleJSON[gameTitle]['link'] + '\">' + gameTitle + '</a>');\n      }\n    });\n  });\n}\n\nfunction getGameTitleString(title) {\n  if (title.includes(\"COMPLETED\")) {\n    var gameTitleString = title.split(\" - \")[0];\n  } else {\n    var gameTitleString = title;\n  }\n\n  return gameTitleString;\n}\n\nfunction addVodLinks() {\n  $.getJSON('https://gist.githubusercontent.com/theoriginalcamper/7ee2ff2401968aff754c7e045abbb14b/raw/esa2016-vod.json').done(function (data) {\n    console.log(data);\n    var titles = _.keys(data);\n    console.log(titles);\n\n    $.each(titles, function (index, title) {\n      // console.log(title);\n      var templateString = generateVodString(title, data);\n      $('tr.border-top:not(.row2) td.center-sm').filter(function (index) {\n        return $(this).text() == title;\n      }).append(templateString);\n    });\n\n    console.log(\"Done\");\n  });\n}\n\nfunction generateVodString(title, data) {\n  var twitchString = 'https://www.twitch.tv/esamarathon/v/' + data[title][\"video-link\"] + '?t=' + data[title][\"time\"];\n\n  if (typeof data[title][\"youtube\"] != 'undefined') {\n    var youtubeString = data[title][\"youtube\"];\n    return ' - <i class=\"fa fa-check\"></i> COMPLETED <a href=\"' + twitchString + '\" class=\"vod-link\"><i class=\"fa fa-twitch\"></i></a> <a href=\"' + youtubeString + '\" class=\"vod-link\"><i class=\"fa fa-youtube-play\"></i></a>';\n  } else {\n    return ' - <i class=\"fa fa-check\"></i> COMPLETED <a href=\"' + twitchString + '\" class=\"vod-link\"><i class=\"fa fa-twitch\"></i></a>';\n  }\n}"],"sourceRoot":"/source/"}
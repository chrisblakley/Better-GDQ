"use strict";function updateUI(e){runners_paragraph.innerHTML=generateFormattedRunnerString(e.runner),game_link_a.href=e.link,game_link_a.onclick=function(){return window.open(this.href),!1},null!=e.category?game_link_a.innerHTML=e.game+" ("+e.category+")":game_link_a.innerHTML=e.game}function updateCalendarUI(e){if(console.log("Calendar updating..."),console.log(e),null!=e){$("#schedule-table tbody").empty();var n="";_.each(e.order,function(t,a){n+=generateScheduleItemString(e.schedule[t],a+1)}),$("#schedule-table tbody").html(n),console.log("Calendar updated.")}}function generateFormattedRunnerString(e){var n=_.keys(e),t="by ";if(n.length>2){var a=n.pop(),r=n.pop();$.each(n,function(n,a){t+=generateRunnerElement(e,a)+", "}),t+=generateRunnerElement(e,r)+" ",t+="and ",t+=generateRunnerElement(e,a)}else if(2==n.length){var a=runner_keys.pop(),r=runner_keys.pop();t+=generateRunnerElement(e,r),t+=" and ",t+=generateRunnerElement(e,a)}else if(1==n.length){n[0];t+=generateRunnerElement(e,n[0])}else console.log("Error no runners."),t="";return t}function generateRunnerElement(e,n){return null==e[n].logo?'<a href="'+e[n].link+'" onclick="window.open(this.href); return false;">'+n+"</a>":'<a href="'+e[n].link+'" onclick="window.open(this.href); return false;"><img class="runner-logo" src="'+e[n].logo+'" />'+n+"</a>"}function generateScheduleItemString(e,n){var t=generateFormattedRunnerString(e.runner);if(null!=e.category)var a=e.title+" ("+e.category+")";else var a=e.title;var r='<tr>\n                                <th scope="row">'+n+'</th>\n                                <td>\n                                    <a class="speedrun-link" id="next-game-title" href="'+e.link+'"> '+a+'</a>\n                                    <p class="runners-links" id="next-runners-information">'+t+'</p>\n                                </td>\n                                <td style="width: 114px;">\n                                    <p class="text-right"><i class="fa fa-clock-o" aria-hidden="true"></i> '+e.estimate+"</p>\n                                </td>\n                              </tr>";return r}function calculateRefreshRate(e){var n=6e4*e;return n}function updateRefreshRate(e){if("Set Refresh Timer:"==e)return console.log("No change in refresh timer value."),void $.notify({icon:"glyphicon glyphicon-warning-sign",title:"Refresh Timer Update:",message:"Please choose an option from the menu!"},{element:"body",position:null,type:"danger",allow_dismiss:!0,newest_on_top:!0,showProgressbar:!1,placement:{from:"top",align:"right"}});if("number"==typeof parseInt(e)&&parseInt(e)>0){clearInterval(refreshTimer);var n=calculateRefreshRate(parseInt(e));setInterval(requestDataFromBackground,n),console.log("Refresh Timer has been updated to: "+e+" minutes or "+n+" milliseconds"),$.notify({icon:"glyphicon glyphicon-time",title:"Refresh Timer Update:",message:"Updated to refresh every "+e+" minutes"},{element:"body",position:null,type:"success",allow_dismiss:!0,newest_on_top:!0,showProgressbar:!1,placement:{from:"top",align:"right"}})}}function sendUpdateCalendarItemsNumber(e){return"Set # of Runs to Display:"==e?(console.log("No change in numbers of runs to display in schedule."),void $.notify({icon:"glyphicon glyphicon-warning-sign",title:"Schedule Items Update",message:"Please choose an option from the menu!"},{element:"body",position:null,type:"danger",allow_dismiss:!0,newest_on_top:!0,showProgressbar:!1,placement:{from:"top",align:"right"}})):void("number"==typeof parseInt(e)&&parseInt(e)>0&&(port.postMessage({message:"schedule",calendarItemsNumber:parseInt(e)}),$.notify({icon:"glyphicon glyphicon-time",title:"Schedule Items Update:",message:"Updated to display "+e+" runs."},{element:"body",position:null,type:"success",allow_dismiss:!0,newest_on_top:!0,showProgressbar:!1,placement:{from:"top",align:"right"}})))}function requestDataFromBackground(){port.postMessage({message:"request"})}var refreshTimer=null,refreshRate=3e5,port=chrome.runtime.connect({name:"gdq"}),page_elem=document.querySelector("body");console.log(page_elem);var runners_paragraph=document.createElement("p"),game_link_a=document.createElement("a");runners_paragraph.id="gdq-runners-information",game_link_a.id="gdq-speedrun-link",game_link_a.className="speedrun-link",$.get(chrome.extension.getURL("/html/gdq-footer.html"),function(e){$($.parseHTML(e)).appendTo(page_elem)}),$.get(chrome.extension.getURL("/html/settings-menu.html"),function(e){var n=$(".settings-menu");$($.parseHTML(e)).appendTo(n)}),$(page_elem).on("click","ul.dropdown-menu",function(e){e.stopPropagation()}),$(document).ready(function(){$(page_elem).css("margin-bottom","70px"),$(".game-information").append(game_link_a),$(".game-information").append(runners_paragraph),$("#refresh-timer-update").on("submit",function(e){e.preventDefault();var n=$("#refresh-timer-update").serializeArray()[0].value;return updateRefreshRate(n),!1}),$("#schedule-items-update").on("submit",function(e){e.preventDefault();var n=$("#schedule-items-update").serializeArray()[0].value;return console.log(n),sendUpdateCalendarItemsNumber(n),!1}),$(".fa.fa-refresh").click(function(){this.className="fa fa-refresh fa-spin",console.log("Refreshing..."),requestDataFromBackground();var e=this;setTimeout(function(){e.className="fa fa-refresh",console.log("Refresh complete.")},2e3)}),$(".fa.fa-cog").click(function(){this.className="fa fa-cog fa-spin";var e=this;setTimeout(function(){e.className="fa fa-cog"},2e3)}),$("[name='quakenet-chat-switch']").bootstrapSwitch(),$('input[name="quakenet-chat-switch"]').on("switchChange.bootstrapSwitch",function(e,n){console.log("Clicked QUAKENET Switch."),$(".bootstrap-switch").hasClass("bootstrap-switch-on")?(console.log("Switch is on. Adding Chat iframe and modifying UI."),$("#stream").removeClass("center-block").addClass("pull-left"),$.get(chrome.extension.getURL("/html/quakenet-chat.html"),function(e){var n=$("#stream");$(n).after($.parseHTML(e))})):(console.log("Switch is off. Removing UI."),$("#stream").addClass("center-block").removeClass("pull-left"),$("#quakenet-chat").remove(),$("#quakenet-clear").remove())})});var port=chrome.runtime.connect({name:"gdq"});port.postMessage({message:"request"}),port.onMessage.addListener(function(e){"changed"==e.status?(console.log(e),updateUI(e),updateCalendarUI(e.calendar)):"unchanged"==e.status?console.log("Current game has not changed since last request"):"reload"==e.status&&(console.log("Reload has occurred"),console.log(e),updateUI(e),updateCalendarUI(e.calendar))}),refreshTimer=setInterval(requestDataFromBackground,refreshRate);
//# sourceMappingURL=contentscript.js.map
